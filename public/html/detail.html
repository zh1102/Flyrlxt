<!DOCTYPE html><html>	<head>		<meta charset="utf-8" />		<title></title>		<link rel="stylesheet" type="text/css" href="../css/homepage.css"/>		<link rel="stylesheet" type="text/css" href="../svg/font.css"/>		<link rel="stylesheet" type="text/css" href="../css/detail.css"/>	</head>	<body style="background:#EDEFF5;">	<div class="box" style="width:100%;height:auto;">		<div class="centerLeft">			<div class="logo">				<img src="../img/LOGO.png"/>			</div>			<ul>				<li>					<a href="homepage.html">首页</a>				</li>				<li style="background: #5093E1;">					<a href="Jindex.html">员工信息管理</a>				</li>				<li>					<a href="Personnel.html">人事变动</a>				</li>				<li>					<a href="recycle.html">回收站</a>				</li>				<li>					<a href="help.html">帮助</a>				</li>			</ul>		</div>		<div class="centerRight">			<div class="logo">				<div class="weather" style="position: absolute;left: 34px;">					<iframe width="420" scrolling="no" height="60" frameborder="0" allowtransparency="true" src="http://i.tianqi.com/index.php?c=code&id=12&icon=1&num=5"></iframe> 				</div>				<div class="search_cen">					<marquee scrollTop="0"  onmouseover=this.stop() onmouseout=this.start()>						<span>公告</span>						<a href="http://news.sina.com.cn/society">最近新闻动态</a>					</marquee>				</div>								<div class="Administrator">					<div class="header_p" id="header_p">						<img src="../img/d4.jpg"/>					</div>										<div class="menu_control">												<p class="menu">管理员<img src="../img/up.png" id="alter"/></p>						<ul class="submenu">														<li><i class="icon-user-plus"></i><span>管理员信息</span></li>							<li id="switchover"><i class="icon-tab"></i><span>切换用户</span></li>							<li id="quit"><i class="icon-switch"></i><span>退出</span></li>													</ul>					</div>				</div>				<div class="right_add">+</div>			</div>			<div class="border-box" style="width:calc(100vw - 130px);height:auto;overflow: hidden;">			<div class="big" style="width:65%;margin-left:0.8%;">				<div class="my" style="width:100%">					<div class="title">个人资料<span class="xg" style="cursor:pointer;float:right;padding-right:20px;color:#F5F5F5">去修改 >></span></div>					<div class="headPhoto" style="width:25%;"></div>					<div class="message" style="width:60%">						</div>				</div>				<div class="myxia" style="width:100%">									</div>			</div>			<div class="myyou" style="width:30%;height:auto;margin-left:3%;">				<div id="msgBox">				<form>				<h2>来 , 说说你在做什么 , 想什么</h2>				<div>				<input id="userName" class="f-text" value="" />				<p id="face"><img src="../img/face1.gif" class="current" /><img src="../img/face2.gif" /><img src="../img/face3.gif" /><img src="../img/face4.gif" /></p>				</div>				<div><textarea id="conBox" class="f-text"></textarea></div>				<div class="tr">				<p>				<span class="countTxt">还能输入</span><strong class="maxNum">140</strong><span>个字</span>				<input id="sendBtn" type="button" value="" title="快捷键 Ctrl+Enter" />				</p>				</div>				</form>				<div class="list">				<h3><span>大家在说</span></h3>				<ul>				<li>				<div class="userPic"><img src="../img/face.gif" /></div>				<div class="content">				<div class="userName"><a href="javascript:;">永不上线</a>:</div>				<div class="msgInfo">新增删除广播功能。</div>				<div class="times"><span>07月05日 15:14</span>				<a class="del" href="javascript:;">删除</a>				</div>				</div>				</li>				<li>				<div class="userPic"><img src="../img/face.gif" /></div>				<div class="content">				<div class="userName"><a href="javascript:;">永不上线</a>:</div>				<div class="msgInfo">新增删除广播功能。</div>				<div class="times"><span>07月05日 15:14</span>				<a class="del" href="javascript:;">删除</a>				</div>				</div>				</li>				</ul>				</div>					</div>							</div>					</div>		</div>	</div>			<div class="header_z">			<asid class="login">				<div>					<i id="loginClose" class="icon-cross"></i>				</div>				<form>					<lable>账号<input type="text" /></lable>					<lable>密码<input type="password" /></lable>					<button>登陆</button>				</form>			</asid>		</div>				<div class="control_mask">			<div class="control_message">								<div class="leftbar">					<i id="controlClose" class="icon-cross"></i>					<div class="tx">						<i class="icon-user"></i>					</div>					<input type="file" id="file_tx"/>					<button id="submit_tx">提交头像</button>					<span>* 点击图片添加头像</span>				</div>							</div>		</div>	</body>
	<script type="text/javascript" src="../js/jquery-2.1.4.min.js"></script>
	<script src="../js/public.js"></script>
	<script type="text/javascript">
		var uid=location.search.substring(4);
		$('.xg').click(function(){
			location.href="modification.html?id="+uid
		})
		$.ajax({
			type:'get',
			url:'http://192.168.43.197:8005/operate/details',
			data:{
				id:uid
			},
			success:function(e){
				for(var i=0;i<e.length;i++){
					//$('.my').find('#name').html(e[i].name)
					if(e[i].department=='r'){
						e[i].department='人事部'
					}else if(e[i].department=='s'){
						e[i].department='市场部'
					}else if(e[i].department=='c'){
						e[i].department='财务部'
					}else if(e[i].department=='j'){
						e[i].department='技术部'
					}
					$('.headPhoto').html('<img src="http://192.168.43.197:8005/upload/'+e[i].img+'">')
					$('.message').append('<p class="one">姓名：'+e[i].name+'</p>'
						+'<p class="one">性别：'+e[i].sex+'</p>'
						+'<p class="two">年龄：'+e[i].age+'</p>'
						+'<p class="two">工号：'+e[i].workNumber+'</p>'
						+'<p class="two">婚姻状态：'+e[i].matrimonialRes+'</p>'
						+'<p class="two">毕业院校：'+e[i].Graduation+'</p>'
						+'<p class="two">专业：'+e[i].specialities+'</p>'
						+'<p class="two">学历：'+e[i].qualificAtions+'</p>'
						+'<p class="two">QQ：'+e[i].QQ+'</p>'
						+'<p class="two">电话号码：'+e[i].tel+'</p>'
						+'<p class="two">邮箱：'+e[i].eml+'</p>'
						+'<p class="one">身份证号码：'+e[i].number+'</p>'
						+'<p class="one">家庭住址：'+e[i].address+'</p>')
					$('.myxia').append('<p>入职时间：'+e[i].entryTime+'</p>'
					+'<p>所在部门：'+e[i].department+'</p>'
					+'<p>职位：'+e[i].zy+'</p>'
					+'<p>离职时间:'+e[i].leavedate+'</p>')
				}
				
			},error:function(){
				console.log('error....')
			}
		})
	</script>
	<script type="text/javascript">
        var theme_list_open = false;
        $(document).ready(function () {
            function fixHeight() {
                var headerHeight = $("#switcher").height();
                $("#iframe").attr("height", $(window).height()-54+ "px");
            }
            $(window).resize(function () {
                fixHeight();
            }).resize();

            $('.icon-monitor').addClass('active');

            $(".icon-mobile-3").click(function () {
                $("#by").css("overflow-y", "auto");
                $('#iframe-wrap').removeClass().addClass('mobile-width-3');
                $('.icon-tablet,.icon-mobile-1,.icon-monitor,.icon-mobile-2,.icon-mobile-3').removeClass('active');
                $(this).addClass('active');
                return false;
            });

            $(".icon-mobile-2").click(function () {
                $("#by").css("overflow-y", "auto");
                $('#iframe-wrap').removeClass().addClass('mobile-width-2');
                $('.icon-tablet,.icon-mobile-1,.icon-monitor,.icon-mobile-2,.icon-mobile-3').removeClass('active');
                $(this).addClass('active');
                return false;
            });

            $(".icon-mobile-1").click(function () {
                $("#by").css("overflow-y", "auto");
                $('#iframe-wrap').removeClass().addClass('mobile-width');
                $('.icon-tablet,.icon-mobile,.icon-monitor,.icon-mobile-2,.icon-mobile-3').removeClass('active');
                $(this).addClass('active');
                return false;
            });

            $(".icon-tablet").click(function () {
                $("#by").css("overflow-y", "auto");
                $('#iframe-wrap').removeClass().addClass('tablet-width');
                $('.icon-tablet,.icon-mobile-1,.icon-monitor,.icon-mobile-2,.icon-mobile-3').removeClass('active');
                $(this).addClass('active');
                return false;
            });

            $(".icon-monitor").click(function () {
                $("#by").css("overflow-y", "hidden");
                $('#iframe-wrap').removeClass().addClass('full-width');
                $('.icon-tablet,.icon-mobile-1,.icon-monitor,.icon-mobile-2,.icon-mobile-3').removeClass('active');
                $(this).addClass('active');
                return false;
            });
        });
    </script>
    <script type="text/javascript">
/*-------------------------- +
  获取id, class, tagName
 +-------------------------- */
var get = {
	byId: function(id) {
		return typeof id === "string" ? document.getElementById(id) : id
	},
	byClass: function(sClass, oParent) {
		var aClass = [];
		var reClass = new RegExp("(^| )" + sClass + "( |$)");
		var aElem = this.byTagName("*", oParent);
		for (var i = 0; i < aElem.length; i++) reClass.test(aElem[i].className) && aClass.push(aElem[i]);
		return aClass
	},
	byTagName: function(elem, obj) {
		return (obj || document).getElementsByTagName(elem)
	}
};
/*-------------------------- +
  事件绑定, 删除
 +-------------------------- */
var EventUtil = {
	addHandler: function (oElement, sEvent, fnHandler) {
		oElement.addEventListener ? oElement.addEventListener(sEvent, fnHandler, false) : (oElement["_" + sEvent + fnHandler] = fnHandler, oElement[sEvent + fnHandler] = function () {oElement["_" + sEvent + fnHandler]()}, oElement.attachEvent("on" + sEvent, oElement[sEvent + fnHandler]))
	},
	removeHandler: function (oElement, sEvent, fnHandler) {
		oElement.removeEventListener ? oElement.removeEventListener(sEvent, fnHandler, false) : oElement.detachEvent("on" + sEvent, oElement[sEvent + fnHandler])
	},
	addLoadHandler: function (fnHandler) {
		this.addHandler(window, "load", fnHandler)
	}
};
/*-------------------------- +
  设置css样式
  读取css样式
 +-------------------------- */
function css(obj, attr, value)
{
	switch (arguments.length)
	{
		case 2:
			if(typeof arguments[1] == "object")
			{	
				for (var i in attr) i == "opacity" ? (obj.style["filter"] = "alpha(opacity=" + attr[i] + ")", obj.style[i] = attr[i] / 100) : obj.style[i] = attr[i];
			}
			else
			{	
				return obj.currentStyle ? obj.currentStyle[attr] : getComputedStyle(obj, null)[attr]
			}
			break;
		case 3:
			attr == "opacity" ? (obj.style["filter"] = "alpha(opacity=" + value + ")", obj.style[attr] = value / 100) : obj.style[attr] = value;
			break;
	}
};

EventUtil.addLoadHandler(function ()
{
	var oMsgBox = get.byId("msgBox");
	var oUserName = get.byId("userName");
	var oConBox = get.byId("conBox");
	var oSendBtn = get.byId("sendBtn");
	var oMaxNum = get.byClass("maxNum")[0];
	var oCountTxt = get.byClass("countTxt")[0];
	var oList = get.byClass("list")[0];
	var oUl = get.byTagName("ul", oList)[0];
	var aLi = get.byTagName("li", oList);
	var aFtxt = get.byClass("f-text", oMsgBox);
	var aImg = get.byTagName("img", get.byId("face"));
	var bSend = false;
	var timer = null;
	var oTmp = "";
	var i = 0;
	var maxNum = 140;
	
	//禁止表单提交
	EventUtil.addHandler(get.byTagName("form", oMsgBox)[0], "submit", function () {return false});
	
	//为广播按钮绑定发送事件
	EventUtil.addHandler(oSendBtn, "click", fnSend);
	
	//为Ctrl+Enter快捷键绑定发送事件
	EventUtil.addHandler(document, "keyup", function(event)
	{
		var event = event || window.event;
		event.ctrlKey && event.keyCode == 13 && fnSend()
	});
	
	//发送广播函数
	function fnSend ()
	{
		var reg = /^\s*$/g;
		if(reg.test(oUserName.value))
		{
			alert("\u8bf7\u586b\u5199\u60a8\u7684\u59d3\u540d");
			oUserName.focus()
		}
		else if(!/^[u4e00-\u9fa5\w]{2,8}$/g.test(oUserName.value))
		{
			alert("\u59d3\u540d\u75312-8\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u3001\u6c49\u5b57\u7ec4\u6210\uff01");
			oUserName.focus()
		}
		else if(reg.test(oConBox.value))
		{
			alert("\u968f\u4fbf\u8bf4\u70b9\u4ec0\u4e48\u5427\uff01");
			oConBox.focus()
		}
		else if(!bSend)
		{
			alert("\u4f60\u8f93\u5165\u7684\u5185\u5bb9\u5df2\u8d85\u51fa\u9650\u5236\uff0c\u8bf7\u68c0\u67e5\uff01");
			oConBox.focus()
		}
		else
		{
			var oLi = document.createElement("li");
			var oDate = new Date();
			oLi.innerHTML = "<div class=\"userPic\"><img src=\"" + get.byClass("current", get.byId("face"))[0].src + "\"></div>\
							 <div class=\"content\">\
							 	<div class=\"userName\"><a href=\"javascript:;\">" + oUserName.value + "</a>:</div>\
								<div class=\"msgInfo\">" + oConBox.value.replace(/<[^>]*>|&nbsp;/ig, "") + "</div>\
								<div class=\"times\"><span>" + format(oDate.getMonth() + 1) + "\u6708" + format(oDate.getDate()) + "\u65e5 " + format(oDate.getHours()) + ":" + format(oDate.getMinutes()) + "</span><a class=\"del\" href=\"javascript:;\">\u5220\u9664</a></div>\
							 </div>";
			//插入元素
			aLi.length ? oUl.insertBefore(oLi, aLi[0]) : oUl.appendChild(oLi);
			
			//重置表单
			get.byTagName("form", oMsgBox)[0].reset();
			for (i = 0; i < aImg.length; i++) aImg[i].className = "";
			aImg[0].className = "current";
			
			//将元素高度保存
			var iHeight = oLi.clientHeight - parseFloat(css(oLi, "paddingTop")) - parseFloat(css(oLi, "paddingBottom"));
			var alpah = count = 0;
			css(oLi, {"opacity" : "0", "height" : "0"});	
			timer = setInterval(function ()
			{
				css(oLi, {"display" : "block", "opacity" : "0", "height" : (count += 8) + "px"});
				if (count > iHeight)
				{
					clearInterval(timer);
					css(oLi, "height", iHeight + "px");
					timer = setInterval(function ()
					{
						css(oLi, "opacity", (alpah += 10));
						alpah > 100 && (clearInterval(timer), css(oLi, "opacity", 100))
					},30)
				}
			},30);
			//调用鼠标划过/离开样式
			liHover();
			//调用删除函数
			delLi()
		}
	};
	
	//事件绑定, 判断字符输入
	EventUtil.addHandler(oConBox, "keyup", confine);	
	EventUtil.addHandler(oConBox, "focus", confine);
	EventUtil.addHandler(oConBox, "change", confine);
	
	//输入字符限制
	function confine ()
	{
		var iLen = 0;		
		for (i = 0; i < oConBox.value.length; i++) iLen += /[^\x00-\xff]/g.test(oConBox.value.charAt(i)) ? 1 : 0.5;
		oMaxNum.innerHTML = Math.abs(maxNum - Math.floor(iLen));	
		maxNum - Math.floor(iLen) >= 0 ? (css(oMaxNum, "color", ""), oCountTxt.innerHTML = "\u8fd8\u80fd\u8f93\u5165", bSend = true) : (css(oMaxNum, "color", "#f60"), oCountTxt.innerHTML = "\u5df2\u8d85\u51fa", bSend = false)
	}
	//加载即调用
	confine();		
	
	//广播按钮鼠标划过样式
	EventUtil.addHandler(oSendBtn, "mouseover", function () {this.className = "hover"});

	//广播按钮鼠标离开样式
	EventUtil.addHandler(oSendBtn, "mouseout", function () {this.className = ""});
	
	//li鼠标划过/离开处理函数
	function liHover()
	{
		for (i = 0; i < aLi.length; i++)
		{
			//li鼠标划过样式
			EventUtil.addHandler(aLi[i], "mouseover", function (event)
			{
				this.className = "hover";
				oTmp = get.byClass("times", this)[0];
				var aA = get.byTagName("a", oTmp);
				if (!aA.length)
				{
					var oA = document.createElement("a");					
					oA.innerHTML = "删除";
					oA.className = "del";
					oA.href = "javascript:;";
					oTmp.appendChild(oA)
				}
				else
				{
					aA[0].style.display = "block";
				}
			});

			//li鼠标离开样式
			EventUtil.addHandler(aLi[i], "mouseout", function ()
			{
				this.className = "";
				var oA = get.byTagName("a", get.byClass("times", this)[0])[0];
				oA.style.display = "none"	
			})
		}
	}
	liHover();
	
	//删除功能
	function delLi()
	{
		var aA = get.byClass("del", oUl);
		
		for (i = 0; i < aA.length; i++)
		{
			aA[i].onclick = function ()
			{
				var oParent = this.parentNode.parentNode.parentNode;
				var alpha = 100;
				var iHeight = oParent.offsetHeight;
				timer = setInterval(function ()
				{
					css(oParent, "opacity", (alpha -= 10));
					if (alpha < 0)
					{
						clearInterval(timer);						
						timer = setInterval(function ()
						{
							iHeight -= 10;
							iHeight < 0 && (iHeight = 0);
							css(oParent, "height", iHeight + "px");
							iHeight == 0 && (clearInterval(timer), oUl.removeChild(oParent))
						},30)
					}	
				},30);			
				this.onclick = null	
			}			
		}
	}
	delLi();
	
	//输入框获取焦点时样式
	for (i = 0; i < aFtxt.length; i++)
	{
		EventUtil.addHandler(aFtxt[i], "focus", function ()	{this.className = "active"});		
		EventUtil.addHandler(aFtxt[i], "blur", function () {this.className = ""})
	}
	
	//格式化时间, 如果为一位数时补0
	function format(str)
	{
		return str.toString().replace(/^(\d)$/,"0$1")
	}
	
	//头像
	for (i = 0; i < aImg.length; i++)
	{
		aImg[i].onmouseover = function ()
		{
			this.className += " hover"
		};
		aImg[i].onmouseout = function ()
		{
			this.className = this.className.replace(/\s?hover/,"")
		};
		aImg[i].onclick = function ()
		{
			for (i = 0; i < aImg.length; i++) aImg[i].className = "";
			this.className = "current"	
		}
	}
});
</script>
</html>
